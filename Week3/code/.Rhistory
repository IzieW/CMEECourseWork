length(d$Tarsus)
hist(d$Tarsus)
mean(d$Tarsus,na.rm = TRUE)
median(d$Tarsus,na.rm = TRUE)
mode(d$Tarsus,na.rm = TRUE)
mode(d$Tarsus)
par(mfrow = c(2,2))
hist(d$Tarsus, breaks = 3, col="grey")
hist(d$Tarsus, breaks = 10, col="grey")
hist(d$Tarsus, breaks = 30, col="grey")
hist(d$Tarsus, breaks = 100, col="grey")
head(table(d$Tarsus))
d$Tarsus.rounded<-round(d$Tarsus,digits=1)
head(d$Tarsus.rounded)
setwd("Documents/CMEECourseWork/Week3/code")
getwd()
source("PP_Regress.R")
MyDF %>% group_by(Type.of.feeding.interaction) %>% summary(lm(Prey.mass ~ Predator.mass, data = MyDF)) %>% summarise(
Slope = coefficients
)
summary(lm(Prey.mass ~ Predator.mass, data = MyDF))
a <- summary(lm(Prey.mass ~ Predator.mass, data = MyDF))
tidy(a)
require(tidyverse)
broom::tidy(a)
a
augment(a)
broom::augment(a)
a
broom::glance(a)
a
broom::augment(a)
MyDF %>% group_by(Type.of.feeding.interaction) %>% nest() %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% group_by(Type.of.feeding.interaction) %>% nest()
MyDF %>% nest(data = -Type.of.feeding.interaction)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = .)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
d <- MyDF %>% nest(data = -Type.of.feeding.interaction)
d %>% mutate(
fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = d)),
tidied = map(fit, tidy)
) %>% unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
rlang::last_error()
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% do(mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy))
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% do(map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF))
)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
d
1[1]
d[1]
d[[1]]
d[1][1]
d %>% unnest()
d %>% unnest() %>% head()
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(MyDF, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = Type.of.feeding.interaction) %>% nest(data = Predator.lifestage)
d                                                                 map())
MyDF %>% nest(data = Type.of.feeding.interaction) %>% nest(data = Predator.lifestage)
MyDF %>% nest(data = Type.of.feeding.interaction) %>% mutate(by_feeding_interaction = map(by_feeding_interaction, ~.x %>% group_by(Predator.lifestage))
)
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(data = map(data, ~.x %>% nest(data = -Predator.lifestage))
)
t <- MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(data = map(data, ~.x %>% nest(data = -Predator.lifestage)))
t %>% unnest
t <- MyDF %>% nest(data = -Type.of.feeding.interaction) # group by type of feeding interaction
%>% mutate(data = map(data, ~.x %>% nest(data = -Predator.lifestage))) # group by Predator.lifestage %>% unnest()
t
unnest(# Fri Nov  5 08:16:53 2021 ------------------------------
)
unnest(t)
t %>% unnest()
t <- MyDF %>% nest(data = -Type.of.feeding.interaction) %>% # group by type of feeding interaction
mutate(data = map(data, ~.x %>% nest(data = -Predator.lifestage))) # group by Predator.lifestage
t %>% unnest()
at_depth(2, t)
?at_depth
at_depth(t, 2)
t <- MyDF %>% nest(data = -Type.of.feeding.interaction) %>% # group by type of feeding interaction
mutate(data = map(data, ~.x %>% nest(data = -Predator.lifestage))) # group by Predator.lifestage
d <- t %>% unnest() # save second level of nesting
d
d %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data =.x)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data =MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
MyDF %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data =MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
MyDF %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d
d %>% unnest()
d
MyDF %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
MyDF %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data =MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
rlang::last_error()
MyDF %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
rlang::last_error()
MyDF %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d
t
t %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
MyDF %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
t %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
rlang::last_error()
t %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
t %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
)
t %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
t %>% mutate(fit = map(t, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
t
d
unnest(t)
t %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d %>% mutate(fit = map(d, ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>% unnest(tidied)
d
data()
mutate(t, models = map(data, data) %>% at_depth(2, ~lm(lifeExp _ year, data = .x)))
mutate(t, models = map(data, data) %>% at_depth(2, ~lm(Prey.mass ~ Predator.mass, data = .x)))
mutate(t, models = map(data, data) %>% map_depth(2, ~lm(Prey.mass ~ Predator.mass, data = .x)))
rlang::last_error()
MyDF %>% nest(data = -Type.of.feeding.interaction) %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
pd <- MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
pd
MyDF %>% map(nest(data=Type.of.feeding.interaction), pd)
MyDF %>% map(nest(data = Type.of.feeding.interaction), pd)
MyDF %>% map(nest(data = -Type.of.feeding.interaction), pd)
MyDF %>% nest(data = -Type.of.feeding.interaction)
i <- MyDF %>% nest(data = -Type.of.feeding.interaction)
map(i, pd)
pls <- t %>% mutate(
fit = map(t, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
t
pls <- t %>% mutate(
fit = map(t, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
pls <- d %>% mutate(
fit = map(d, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
d
t %>% mutate(
fit = map(d, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
t %>% mutate(
fit = map(d, ~ lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
t %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
d %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)
) %>%
unnest(tidied)
d %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy),
glanced = map(fit, broom::glance)
) %>%
unnest(tidied)
unnest(glanced)
regressions <- d %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy),
glanced = map(fit, broom::glance)
)
regressions %>% unnest()
regressions %>% unnest(tidied)
regressions %>% unnest(glanced)
regressions
colnames(regressions(tidied))
colnames(regressions$tidied)
regressions$tidied
regressions %>% unnest(glanced)
colnames(regressions$tidied)
regressions %>% unnest(tidied)
regressions <- d %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy),
glanced = map(fit, broom::glance)
)
regressions <- t %>% mutate(
fit = map(data, ~ lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy),
glanced = map(fit, broom::glance)
)
regressions %>% unnest(tidied)
head(MyDF)
ddply(MyDF, "Predator.lifestage", summarise, lm = lm(Prey.mass ~ Predator.mass, data = MyDF))
MyDF %>% group_by("Predator.lifestage")
df <- MyDF %>% group_by("Predator.lifestage") %>% do(fit = lm(Prey.mass ~ Predator.mass, data =.))
df = MyDF %>% group_by("Predator.lifestage") %>% do(fit = lm(Prey.mass ~ Predator.mass, data =.))
table = tidy(df, fit)
table = broom:tidy(df, fit)
table = broom::tidy(df, fit)
df
fit
df$fit
df
MyDF %>% group_by(Predator.lifestage)
df = MyDF %>% group_by(Predator.lifestage) %>% do(fit = lm(Prey.mass ~ Predator.mass, data =.))
df
df$fit
tidy(df)
broom::tidy(df)
ungroup(df)
df
summarise(df, fit)
map(fit, broom::tidy)
map(df$fit, broom::tidy)
MyDF %>% nest(Predator.lifestage)
MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
)
MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
) %>% unnest()
MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
) %>% unnest(tidied)
MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
)%>% unnest(tidied)
MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
%>% unnest(tidied)
MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance)) %>% unnest(tidied)
regressions %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
regressions <- %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
regressions <- %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance)
regressions <- MyDF %>% nest(data = -Predator.lifestage) %>% mutate(
fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
regressions(tidy)
regressions(tidied)
regressions %>% unnest(tidied)
t
d
map(d, ~lm(Prey.mass ~ Predator.mass, data = MyDF))
d
d[2]
d
d %>% mutate( fit = map(d[2], ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)) %>% unnest()
d %>% mutate( fit = map(d[2], ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)) %>% unnest(tidied)
d
d[3]
d[[3]]
d %>% mutate( fit = map(d[3], ~lm(Prey.mass ~ Predator.mass, data = MyDF)),
tidied = map(fit, broom::tidy)) %>% unnest(tidied)
MyDF %>% nest(data = -Type.of.feeding.interaction)
MyDF %>% nest(data = -Type.of.feeding.interaction)
data()
q <- MyDF %>% nest(data = -Type.of.feeding.interaction)
q
q$data
q
q$data %>% nest(data = -Predator.lifestage)
d
d %>% mutate(fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidied)) %>% unnest(tidied)
d %>% mutate(fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy)) %>% unnest(tidied)
source("PP_Regress.R")
getwd(0)
getwd()
t <- MyDF %>% nest(data = -Type.of.feeding.interaction) %>% # group by type of feeding interaction
mutate(data = map(data, ~.x %>% nest(data = -Predator.lifestage))) # group by Predator.lifestage
d <- t %>% unnest() # save second level of grouping
regress <- d %>% mutate( fit = map(data, ~lm(Prey.mass ~ Predator.mass, data = .x)),
tidied = map(fit, broom::tidy),
glance = map(fit, broom::glance))
source("PP_Regress.R")
regress %>% unnest(tidied)
regress
regress %>% unnest(tidied)
regress %>% summarise(tidied$estimate)
regress %>% summarise(co = tidied$estimate)
regress %>% summarise(tidy = tidied)
regress %>% summarise(tidy = $tidied)
regress %>% summarise(tidy = tidied())
regress %>% summarise(tidy = unnested(tidied))
regress %>% summarise(tidy = unnest(tidied))
regress
regress %>% unnest(tidied)
regress %>% unnest(tidied) %>% select(estimate)
regress %>% unnest(tidied) %>% select(term, estimate)
coef <- regress %>% unnest(tidied) %>% select(term, estimate)
pivot_wider(coef, names_from = "term", values_from = "estimate")
pivot_wider(coef, names_from = term, values_from = estimate)
values_fn = length
`values_fn = length`
pivot_wider(coef, names_from = term, values_from = estimate)
coefw<- pivot_wider(coef, names_from = term, values_from = estimate)
coefw
head(coefw)
class(coefw)
print(coefw)
unnest(coefw)
coef <- regress %>% unnest(tidied) %>% select(term, estimate) %>% #select slope and intercept from tidied
pivot_wider(names_from = term, values_from = estimate) #reshape data
coef
coef <- regress %>% unnest(tidied) %>% select(term, estimate) %>% #select slope and intercept from tidied
pivot_wider(names_from = term, values_from = estimate) %>% #reshape data
unnest()
coef
plot(coef[1,])
y = coefs$Predator.mass[1]
y = coef$Predator.mass[1]
y
x <- 1
regress
unnest(tidied)
regress %>% unnest(tidied)
x
y
y <- x*coef$Predator.mass[1] + coef$`(Intercept)`[1]
y
plot(x,y)
abline(x,y)
plot(x~y)
qplot(x=x, y=y)
coef
colnames(coef) <- ("Intercept", "slope")
colnames(coef) <- c("Intercept", "slope")
coef
regress
regress %>% unnest(glance)
regress %>% unnest(glance) %>% select(r.squared, f.value = statistic, p.value)
g <- regress %>% unnest(glance) %>% select(r.squared, f.value = statistic, p.value)
regress %>% unnest(glance) %>% glimpse()
lm(Prey.mass~Predator.mass, data = MyDF)
summary(lm(Prey.mass~Predator.mass, data = MyDF))
git
fit
regress
regress %>% unnest(fit)
regress$fit
summary(regress$fit)
regress$fit[1]
summary(regress$fit[1])
summary(lm(Prey.mass[1]~Predator.mass[1], data = data()))
summary(lm(Prey.mass[1]~Predator.mass[1], data = d)
)
summary(lm(Prey.mass[1]~Predator.mass[1], data = d$data)
)
bindcols(regress$Type.of.feeding.interaction, regress$Predator.lifestage, coef, g)
bind_cols(regress$Type.of.feeding.interaction, regress$Predator.lifestage, coef, g)
bind_cols(regress[,1:2], coef, g)
df_regress <- bind_cols(regress[,1:2], coef, g)
class(df_regress)
regress$tidied
regress$tidied$estimate
regress$tidied[1]
regress$tidied[1][1]
regress$tidied[[1]][1]
regress$tidied[[1]]$term
source("PP_Regress.R")
